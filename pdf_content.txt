Topology optimization of a pseudo 3D thermoﬂuid heat sink model
Jan H.K. Haertela,⇑, Kurt Engelbrechta, Boyan S. Lazarovb, Ole Sigmundb
a Department of Energy Conversion and Storage, Technical University of Denmark, Frederiksborgvej 399, 4000 Roskilde, Denmark
b Department of Mechanical Engineering, Technical University of Denmark, Nils Koppels Allé Building 404, 2800 Kgs. Lyngby, Denmark
article info
Article history:
Received 1 September 2017
Received in revised form 15 January 2018
Accepted 17 January 2018
Available online 7 March 2018
Keywords:
Topology optimization
Heat sink design
Thermoﬂuid modeling
Forced convection
abstract
This paper investigates the application of density-based topology optimization to the design of air-cooled
forced convection heat sinks. To reduce the computational burden that is associated with a full 3D opti-
mization, a pseudo 3D optimization model comprising a 2D modeled conducting metal base layer and a
thermally coupled 2D modeled thermoﬂuid design layer is used. Symmetry conditions perpendicular to
the ﬂow direction are applied to generate periodic heat sink designs. The optimization objective is to
minimize the heat sink heat transfer resistance for a ﬁxed pressure drop over the heat sink and a ﬁxed
heat production rate in the base plate. Optimized designs are presented and the resulting ﬁn geometry
is discussed from a thermal engineering point of view and compared to ﬁn shapes resulting from a pres-
sure drop minimization objective. Parametric studies are conducted to analyze the inﬂuence of the pres-
sure drop on the heat sink heat transfer resistance. To quantify the inﬂuence of the assumptions made in
the pseudo 3D optimization model, validation simulations with a body-ﬁtted mesh in 2D and 3D are con-
ducted. A good agreement between optimization model and validation simulations is found, conﬁrming
the physical validity of the utilized optimization model. Two topology optimized designs are exemplarily
benchmarked against a size optimized parallel ﬁn heat sink and an up to 13.6% lower thermal resistance
is found to be realized by the topology optimization.
/C2112018 Elsevier Ltd. All rights reserved.
1. Introduction
Forced convection heat sinks are used in a wide range of appli-
cations. This paper focuses on the design of air-cooled heat sinks as
used for micro-electronics cooling since thermal management is
increasingly becoming a bottleneck for advancement in the design
of these systems [1]. Moreover, better heat management allows
electronics to operate at higher performance for longer periods of
time [2]. Classical heat sink designs applied to electronics cooling
are mainly pin ﬁn and parallel plate ﬁn designs often with air as
the coolant due to availability, simplicity of operation and low cost.
Also microchannel heat sinks cooled by liquids such as water and
oil have been investigated in various works as they allow for the
rejection of higher speciﬁc power rates than air-cooled heat sinks.
A comprehensive review of microchannel heat sinks considering
channel geometry, ﬂow conditions, and utilized coolants is given
in [3]. The heat transfer and ﬂuid dynamics in heat sinks are for
example described in[4]. Various later works deal with the design
and optimization of forced convection heat sinks: for instance Lee
et al.[5] apply a simulation model based on analytical equations to
the prediction and optimization of the thermal performance of ﬁn
heat sinks. Park et al.[6] use the results of 3D CFD simulations to
create a Kriging metamodel which is used for shape optimization
of a plate ﬁn heat sink. With the above mentioned methods signif-
icant improvements in the thermal design of heat sinks can be
achieved; however, they are limited in the sense that an a priori
design parametrization is needed both for the ﬁn shape and the
position of the ﬁns relative to each other. In contrast, topology
optimization allows for almost unlimited design freedom which
makes it possible to identify also unintuitive and complex opti-
mized structures without relying on the design engineer’s intu-
ition. This aspect becomes even more important with the
increasing maturing of additive manufacturing technologies as
these methods provide unprecedented design freedom.
Topology optimization [7] was developed in the context of
structural engineering but has since then been applied to a wide
range of engineering disciplines such as acoustics, photonics, and
ﬂuid ﬂow [8]. It is a means to optimize the material distribution
in a given design domain subject to certain constraints. In
density-based topology optimization, which is used in this work,
a density-ﬁeld is introduced that can take the value of 0 (solid)
or 1 (void) in each point of a design domain. This binary optimiza-
tion problem is relaxed to continuous values between 0 and 1 to
https://doi.org/10.1016/j.ijheatmasstransfer.2018.01.078
0017-9310//C2112018 Elsevier Ltd. All rights reserved.
⇑ Corresponding author.
E-mail address: jhkh@dtu.dk (J.H.K. Haertel).
International Journal of Heat and Mass Transfer 121 (2018) 1073–1088
Contents lists available atScienceDirect
International Journal of Heat and Mass Transfer
journal homepage: www.else vier.com/locate/ijhmt

allow for the use of efﬁcient gradient-based optimization tech-
niques. In the presented thermoﬂuid design problem 0 corresponds
to heat sink material and 1 to ﬂuid passage, thus allowing for a
ﬂexible representation of arbitrary heat sink ﬁn geometries during
the optimization. Topology optimization applied to the design of
thermal systems such as heat sinks and heat exchangers is an
active ﬁeld of research[9]. Early applications of topology optimiza-
tion to heat transfer problems consider 2D heat conduction prob-
lems with convective heat transfer to an ambient ﬂuid in the
out-of-plane direction by assuming a constant heat transfer coefﬁ-
cient as e.g.[10]. When treating 2D conduction problems with con-
vective heat transfer within the modeled plane, the design
dependent convective boundary to the ﬂuid needs to be captured
which can be done by using an interpolation scheme[11–13],b y
applying level set based topology optimization to track the bound-
ary [14], or by comparing the density of adjacent elements in the
ﬁnite element mesh [15]. A constant heat transfer coefﬁcient is
assumed in [11,12,14] whereas [13,15] use a surrogate model for
the heat transfer coefﬁcient to capture the dependence of the local
convective heat transfer on the geometry of the optimized struc-
ture to some degree. More recently published works present also
3D optimization models with diffusive heat transport in the solid
and design dependent convective boundaries with a constant heat
transfer coefﬁcient using density-based[16,17] and level set[18]
topology optimization. Dede and coworkers[16] use additive layer
manufacturing to fabricate and subsequently experimentally eval-
uate an optimized heat sink design. The thermal integration of a
thermoelectric cooler in a robotic downhole intervention tool
using topology optimization to distribute conducting and insulat-
ing material in a 3D domain as well as fabrication and experimen-
tal validation of the prototype is presented in[19]. Pizzolato et al.
[20] apply density-based topology optimization to the design of
conducting ﬁns in a phase change material (PCM) storage tank
modeling the solidiﬁcation of the PCM as transient thermal diffu-
sion problem both in 2D and 3D.
The topology optimization works presented above simplify the
heat transfer to the ambient ﬂuid to Newtons law of cooling, i.e.
assuming a constant heat transfer coefﬁcient or a surrogate model
for it. This limiting assumption can be avoided when using ther-
moﬂuid, or conjugate heat transfer, topology optimization models
which also explicitly consider the heat transfer in the ﬂuid during
the optimization. First fairly academic applications of topology
optimization to 2D forced convection conjugate heat transfer prob-
lems are given in [21,22]. 2D topology optimization of water-
cooled microchannel heat sinks is presented in[23] solving the
Navier-Stokes equations and [24] assuming Stokes ﬂow where
[24] fabricate and experimentally evaluate an optimized heat sink
prototype. Matsumori et al.[25] apply topology optimization to a
2D thermoﬂuid heat exchanger model; however, assuming the
same thermal conductivity in solid and ﬂuid. Similar heat exchan-
ger models are treated in [26] that apply 2D lattice Boltzmann
modeling and [27] who use a level set topology optimization
approach to generate optimized designs in 2D and 3D. Qian and
Dede [28] present a thermoﬂuid model for topology optimization
under tangential thermal gradients. The abovementioned works
on thermoﬂuid topology optimization, except for [27] that also
conduct 3D optimizations, rely on 2D optimization models. This
approach was extended by [29] and later [30] to a pseudo 3D
Nomenclature
AXd design domain area
bj convexity parameter in interpolation function
c heat capacity
Cj parameter in RAMP interpolation
Da Darcy number
F volumetric force
f ﬁn volume fraction
h heat transfer coefﬁcient
Ia friction interpolation function
Ih heat transfer interpolation function
Ik conductivity interpolation function
k thermal conductivity
Lc characteristic length
n normal vector
neval number of model evaluations
p pressure
_qinter transferred heat between base plate and design layer
_Qprod produced heat in base plate
r residual of discretized multiphysics problem
rfilter ﬁlter parameter
Rth thermal resistance
s state vector of multiphysics problem
T temperature
u velocity vector
Vbase plate volume base plate
x xy-coordinate vector
Dzbase plate thickness base plate
Dzchannel thickness channel
Abbreviations
2D two-dimensional
3D three-dimensional
min. minimize
PDE partial differential equation
s.t. subject to
Greek symbols
a maximum inverse permeability
b projection steepness parameter
c design variable
~c ﬁltered design variable
~c projected design variable
Cj domain boundary j
g projection threshold parameter
lf dynamic ﬂuid viscosity
qf ﬂuid density
Xj domain j
Subscripts
air air
av average
d design domain
f ﬂuid
i counter subscript
in inlet
j counter subscript
max maximum
out outlet
s solid
symm symmetry
w wall
1074 J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088
model with a heat sink base plate thermally interacting with a
thermoﬂuid design layer that represents the heat sink ﬁns and
ﬂuid ﬂow. The extension of the presented work which also deals
with a pseudo 3D heat sink model compared to[29,30] is discussed
later in this section. A fully developed ﬂow heat exchanger model
is given in[31] where the ﬂuid ﬂow is perpendicular to the design
domain. All above presented works on thermoﬂuid topology opti-
mization treat laminar ﬂow problems. Turbulent ﬂow topology
optimization is still in its very beginnings and, to the authors’ best
knowledge, only Kontoleontos et al.[32] have applied turbulent
ﬂow topology optimization to a conjugate heat transfer problem,
albeit with the simpliﬁcation of not considering the temperature
ﬁeld in the solid. Natural convection problems have only more
recently been investigated due to the complex coupling of ﬂuid
and temperature problem. Alexandersen et al.[33] pioneered this
area presenting a 2D natural convection heat sink topology opti-
mization model that was later extended to 3D [34] and large-
scale 3D [35]. Level set based topology optimization applied to
3D and 2D transient natural convection problems is treated in[36].
Full 3D optimization models allow to exploit 3D design free-
dom; however, at the cost of high computational demand. Con-
ducting such optimizations is currently only possible using a
computer cluster and parallelizable optimization models [35].
The computational effort is signiﬁcantly reduced when using a
pseudo 3D heat sink model comprised of the 2D modeled base
plate and 2D thermoﬂuid design layer while it allows for more
detailed modeling than pure 2D heat sink topology optimization
models. Such pseudo 3D models can be optimized on a powerful
desktop computer and, therefore, be applied by a broader range
of users than models which require access to high performance
computing tools. Steady state laminar ﬂow pseudo 3D heat sink
models, as analyzed in this study, have been treated before in con-
ference papers [29,30]; however, without detailed discussion of
the results. Furthermore, full 3D validation simulations that can
be used to assess assumptions regarding the heat transfer between
base plate and thermoﬂuid design layer and other simpliﬁcations
have not yet been conducted. This is done in the presented study
and considered one of the main contributions of this work. More-
over, the validation simulations are conducted using a body-
ﬁtted mesh and explicit representation of the solid-ﬂuid boundary
to assess the accuracy of the implicit solid-ﬂuid representation
based on a density ﬁeld which inherently has some grey area at
the solid-ﬂuid interface. This has previously been done in[25] for
forced convection conjugate heat transfer topology optimization;
nevertheless, only for one exemplary design in 2D and assuming
equal thermal conductivity in the solid and ﬂuid. In this work,
2D and 3D validation simulations are conducted over the entire
range of analyzed pressure drops to assess the difference between
the optimization model, 2D body-ﬁtted mesh validation model,
and 3D body-ﬁtted mesh validation model separately. A novelty
for thermoﬂuid topology optimization in this work is the applica-
tion of symmetry conditions at the boundaries perpendicular to
the ﬂow direction to generate periodic heat sink designs. Further-
more, this is the ﬁrst forced convection thermoﬂuid topology opti-
mization study to use air as a coolant, which is challenging for the
optimization due to the large conductivity difference between air
and metal, apart from[31] that rely on a simpliﬁed fully developed
ﬂow model. Also, analyzing differences in ﬁn shapes between ther-
mal resistance and pressure drop minimization, as done in this
study, is a novelty in works on topology optimization. Two exem-
plary topology optimized designs are compared to size optimized
parallel ﬁn designs to provide a quantitative benchmarking against
a simpler established heat sink geometry. A comparable bench-
marking has so far in studies on thermoﬂuid topology optimization
only been conducted for the simpliﬁed fully developed ﬂow model
treated in[31].
2. Heat sink model
2.1. General model description
A 3D sketch of a forced convection heat sink as treated in this
work can be seen inFig. 1(left). Heat is generated in the heat sink
base plate and transferred to the ﬂuid ﬂowing between the ﬁns.
Since topology optimization typically requires several hundred
iterations until convergence to a ﬁnal design, a full 3D optimiza-
tion is computationally expensive. Hence, a pseudo 3D heat sink
optimization model, as shown in Fig. 1
(right), which approxi-
mates the original 3D heat sink model as two 2D thermally cou-
pled problems is used in this work. The simpliﬁed model consists
of a 2D thermoﬂuid design layer that represents the original 3D
thermoﬂuid problem in the ﬂuid ﬂow and heat sink ﬁns and of
a 2D conductive base plate layer that represents the original 3D
thermal diffusion problem in the heat sink base plate. The mod-
eling of the heat transfer between the two coupled layers is
described in Section2.2.2. Two different thermoﬂuid design layer
geometries, corresponding to heat sinkmodel a and model b , are
shown inFig. 2. The respective design layer consists of the design
domain, Xd, and non-optimizable pure ﬂuid area, Xf . As men-
tioned above, the design variable ﬁeld can represent either heat
sink ﬁn material or ﬂuid passage at each point of the design
domain; thus, allowing for a ﬂexible optimization of the ﬁn topol-
ogy. The heat sink base plate is below the design domain and has
the same ﬁxed area asXd. The modeling of the thermal coupling
between the base plate and thermoﬂuid design layer is described
in Section2.2.2. Fig. 2states additionally the boundary conditions
and dimensions ofmodel a and model b . For both 2D models and
the corresponding 3D validation models, a channel height,
Dzchannel, of 8 mm and a thickness of the metal base plate,
Dzbase plate , of 0.2 mm are assumed. However, in Section5.2.5,a
reduced base plate thickness of 0.005 mm is analyzed in order
to emphasize hotspots. Symmetry conditions are applied at the
top and bottom boundary ofmodel a which leads to a periodic
heat sink design perpendicular to the air ﬂow direction. Inmodel
b, symmetry is assumed only at the top boundary of the design
domain so that the modeled area corresponds to the bottom half
of the entire heat sink. This second non-periodic heat sink geom-
etry with inlet and outlet width smaller than the design domain
width represents a design problem where the best design is less
intuitive, although it does not necessarily represent a practical
application. This case is optimized to demonstrate the potential
of the topology optimization method to generate more complex
designs and to show a case where the optimal number of ﬁns
of the design changes for different pressure drops over the heat
sink.
2.2. Thermoﬂuid modeling
Throughout this work, an incompressible, laminar, and
steady-state ﬂow is assumed. Furthermore, as described in the
previous section, the ﬂuid and heat transfer problems in the
thermoﬂuid design layer are modeled two-dimensionally. This
2D assumption is motivated by the fact that the ﬁn height is sig-
niﬁcantly larger than the xy-dimensions. Also the original 3D
thermal diffusion problem in the base plate is simpliﬁed to a
2D problem as the xy-dimensions of the base plate are much lar-
ger than its height. The validity of these simpliﬁcations is
assessed in Section 5.2.2.
2.2.1. Fluid dynamics modeling
Assuming an incompressible ﬂuid and two-dimensional ﬂow in
the xy-plane, the continuity equation and Navier-Stokes equation
are deﬁned as:
J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088 1075
qf ðr /C1 uÞ¼ 0 ð1Þ
qf /C1ð u /C1 rÞ u ¼/C0 rp þ lf ðr2uÞþ F ð2Þ
where qf is the ﬂuid density,u is the ﬂuid velocity vector,p is the
pressure ﬁeld, lf is the dynamic viscosity of the ﬂuid, andF is the
Brinkman friction term. The Brinkman friction term is used in ﬂuid
ﬂow topology optimization to penalize ﬂow through solid areas
within the design domain and corresponds to the force exerted on
a ﬂuid ﬂowing through an ideal porous medium[37]. It is deﬁned
as:
FðcÞ¼/C0 au IaðcÞ in Xd ð3Þ
where a is the maximum inverse permeability of the porous med-
ium andI1ðcÞ a suitable function for the inverse permeability inter-
polation which is stated and discussed in Section3.1. The maximum
inverse permeability is computed by:
a ¼ lf =ðDa L2
c Þð 4Þ
where Da is the Darcy number andLc a characteristic length which
corresponds to the design domain width within this work. Ideally,
the value of a would be set to inﬁnity to prevent any ﬂuid from
ﬂowing through solid areas. However, very high values ofa can
cause numerical problems and issues with convergence to poor
local optima. Therefore, the choice ofa,o rDa from whicha follows,
needs to be a tradeoff that ensures negligible ﬂuid ﬂow through the
solid while avoiding problems with numerical stability and the
optimization trajectory. Outside the design domain, no Brinkman
friction is exerted on the ﬂuid; hence:
F ¼ 0 in Xf ð5Þ
The pressure drop between inlet and outlet,Dp, is prescribed in
both model a and model b :
pjCin
/C0 pjCout ¼ Dp ð6Þ
where pjCin
and pjCout is the respective pressure at the inlet and out-
let of the modeled domain as speciﬁed inFig. 2. Additionally, a nor-
mal laminar inﬂow is set at the inlet boundary,Cin. The symmetry
boundary condition for the ﬂuid ﬂow is given by the following
two equations:
u /C1 n ¼ 0o n Csymm ð7Þ
K /C0ð K /C1 nÞ n ¼ 0 on Csymm ð8Þ
where n is the vector normal to the respective boundary andK is
deﬁned as:
K ¼½ lf ðru þð ruÞT Þ/C138n ð9Þ
Fig. 1. Left: 3D sketch of a forced convection heat sink as treated in this work including base plate (brown), ﬁns (yellow) and modeled domain for air ﬂow (grey). Exemplarily,
pin ﬁns are depicted in yellow. Right: Simpliﬁed pseudo 3D model consisting of a 2D thermoﬂuid design layer where green corresponds to the design domain and grey to non-
optimizable ﬂuid area as well as the 2D modeled base plate (brown). The thermoﬂuid design layer is also shown in the 3D model for illustrative purposes.(For interpretation
of the references to colour in this ﬁgure legend, the reader is referred to the web version of this article.)
Fig. 2. Schematic illustration of the domainsXi and boundariesCj as well as dimensions in mm of heat sinkmodel a and model b . The design domain is highlighted in green,
the non-optimizable ﬂuid area in grey, the symmetry boundaries are marked with a red line, the inlet and outlet boundaries with an orange line, and the wall boundaries with
a black line. Please note that the models are not true to scale relative to each other. (For interpretation of the references to colour in this ﬁgure legend, the reader is referred to
the web version of this article.)
1076 J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088
In model b , a no slip condition is imposed on the wall boundaries,
Cwall.
2.2.2. Heat transfer modeling
In the thermoﬂuid design layer outside the design domain, the
2D thermal convection-diffusion equation without heat source or
heat sink is solved which is given by:
qf cf u rTf /C0 r /C1ð kf rTf Þ¼ 0i n Xf ð10Þ
where Tf is the temperature ﬁeld in the thermoﬂuid design layer,cf
the speciﬁc ﬂuid heat capacity, andkf the thermal conductivity of
the ﬂuid. Within the design domain, the following 2D thermal
convection-diffusion equation is solved:
cqf cf u rTf /C0 r /C1ð kf IkðcÞ rTf Þ¼ _qinterðcÞ
Dzchannel
in Xd ð11Þ
where IkðcÞ is a function that interpolates between the thermal
conductivity of the ﬂuid, kf , and that of the heat sink material,
ks. The interpolation function used forIkðcÞ is stated in Section3.1.
The term _qinterðcÞ represents the heat transferred from the solid
base plate to the thermoﬂuid design layer and Dzchannel is the
height of the air channel and ﬁns. By multiplying the advective
energy transport term in Eq.(11) with c, a linear penalization of
the advective energy transport through solid areas is added, as it
was done in [25,28,31]. This ensures that slight ﬂuid leakage
through solid areas, which is to some degree unavoidable in
density-based topology optimization, does not result in advective
energy transport through these regions. It should be noted that
the temperature problem is coupled to the ﬂuid problem through
the velocity ﬁeld u; nevertheless, there is no back coupling from
the temperature problem to the ﬂuid problem since constant ther-
mophysical properties for air are assumed throughout this work.
The thermophysical properties of air used in this study are stated
in Section5.1. In the metal base plate, a 2D heat conduction prob-
lem is solved:
r /C1ð ks rTsÞ¼/C0
_Qprod
Vbase plate
þ
_qinterðcÞ
Dzbase plate
in Xd ð12Þ
where ks is the base plate thermal conductivity,Ts is the tempera-
ture ﬁeld in the base plate,_Qprod is the prescribed heat production
rate, Vbase plate is the volume of the base plate, andDzbase plate is the
height of the base plate. In all studies presented in this work, apart
from Section5.2.5, a uniform heat production rate is assumed in the
base plate. The out-of-plane heat transfer between base plate and
thermoﬂuid design layer, _qinterðcÞ, needs to ﬂexibly represent both
the conductive heat transfer from the base plate into the heat sink
ﬁns as well as the convective heat transfer from the base plate to
the ﬂuid. This is achieved by using a heat transfer coefﬁcient which
is interpolated between a high conductive heat transfer into the ﬁns
and a lower convective heat transfer to the ﬂuid:
_qinterðcÞ¼ hf IhðcÞð Ts /C0 Tf Þð 13Þ
where hf is the heat transfer coefﬁcient describing the convective
heat transfer to the ﬂuid and IhðcÞ is a function interpolating
between hf and the heat transfer coefﬁcient from the base plate into
the heat sink ﬁns,hs. The parameterhs represents the conductive
heat transfer resistance in the z-direction in the ﬁns and is empiri-
cally determined.
The ﬂuid inlet temperature is set to the ﬁxed valueTin:
Tf ¼ Tin on Cin ð14Þ
The outlet, symmetry, and adiabatic wall boundary condition for
the temperature ﬁeld in the thermoﬂuid design layer is given by:
n /C1 rTf ¼ 0o n Cout [ Csymm [ Cwall ð15Þ
Perfect thermal insulation is moreover assumed on all boundaries
of the heat sink base plate:
n /C1 rTs ¼ 0o n @Xd ð16Þ
3. Topology optimization
3.1. Interpolation functions
A continuous design ﬁeld,cðxÞ, taking values between 0 and 1 is
introduced in density-based topology optimization. In the given
design problem, 1 corresponds to ﬂuid passage, 0 to heat sink ﬁn
material, and interpolation functions are used to represent inter-
mediate values. For the Brinkman friction term, an interpolation
function as stated in[33] and ﬁrst introduced in[37] is used in this
work:
IaðcÞ¼ 1 /C0 c
1 þ ba c ð17Þ
where ba is a parameter determining the convexity of the interpo-
lation. For the interpolation of the thermal conductivity within
the design layer and the heat transfer between heat sink base plate
and thermoﬂuid design layer, a RAMP-style interpolation as used in
[33] and originally presented in[38] is applied:
IjðcÞ¼ c ðCjð1 þ bjÞ/C0 1Þþ 1
Cj ð1 þ bj cÞ j ¼ k; h ð18Þ
where bj is the interpolation convexity parameter andCj is deﬁned
in the respective case by:
Ck ¼ kf
ks
ð19Þ
Ch ¼ hf
hs
ð20Þ
3.2. Problem formulation
The optimization objective considered in this work is to mini-
mize the heat sink thermal resistance for a prescribed pressure
drop over the heat sink and prescribed heat production rate. The
thermal resistance of the heat sink,Rth, is deﬁned as:
Rthðc; sÞ¼ Ts;av ðc; sÞ/C0 Tin
_Qprod
ð21Þ
where Ts;av is the average temperature in the base plate ands is
the state vector of the thermoﬂuid problem stated in Section2.2.
Thus, the topology optimization problem can be stated as
follows:
min: :c Rthðc; sÞ
s:t: : rðc; sÞ¼ 0ZZ
Xd
ð1 /C0 cÞdxdy /C0 fA Xd 6 0
0 6 cðxÞ 6 1 8 x 2 Xd
ð22Þ
where rðc; sÞ is the residual of the ﬁnite element formulation of the
thermoﬂuid problem stated in Section2.2, AXd is the design domain
area, and f is the prescribed maximum ﬁn volume fraction or ﬁn
cross-sectional area fraction. The pressure drop over the heat sink
does not appear explicitly as constraint in this statement since it
is prescribed as boundary condition in the thermoﬂuid model. The
ﬁn volume fraction constraint is set in parentheses since it is omit-
ted in this work except for Section5.2.4. In general, this volume
fraction constraint is not needed in the optimization formulation
J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088 1077
(22) unless constraining the total ﬁn volume would be desired for
some design reason. If the entire cross-section is occupied by ﬁns
(f ¼ 1), no ﬂuid ﬂows over the heat sink which would be fairly
detrimental to the heat sink thermal performance. If there is no
ﬁn material at all in the cross-section (f ¼ 0), the heat can only be
transferred directly from the base plate to the ﬂuid which is also
ineffective as the ﬁns provide much more contact area between
heat sink and ﬂuid than the base plate. Hence, due to the physics
of the optimization problem, the optimal value off will always be
in between these two extreme cases. In Section5.2.4, also the pres-
sure drop over the heat sink is minimized for a ﬁxed ﬂuid inlet
velocity that is prescribed as boundary condition in the thermoﬂuid
model and subject to a constraint on the ﬁn volume fraction. This
optimization problem is given by:
min: :c Dpðc; sÞ
s:t: : rðc; sÞ¼ 0ZZ
Xd
ð1 /C0 cÞ dxdy /C0 fA Xd P 0
0 6 cðxÞ 6 1 8 x 2 Xd
ð23Þ
In the case of pressure drop minimization, a minimum cross-
sectional area fraction constraint is needed since the lowest pres-
sure drop for a prescribed ﬂuid inlet velocity will always be
obtained by a design with no ﬁn material in the cross section
(f ¼ 0). It should be noted that in the thermal resistance minimiza-
tion problem, in contrast, a maximum cross-sectional area fraction
constraint is applied as the values off analyzed in Section5.2.4 are
below thef value that minimizes the heat sink thermal resistance in
that speciﬁc case.
3.3. PDE ﬁlter and projection
Density ﬁltering is needed in thermoﬂuid topology optimization
to avoid problems with ill-posedness of the optimization problem
[39]. A Helmholtz-type partial differential equation (PDE) ﬁlter
[40] is used in this study which is deﬁned as follows:
/C0 r2
filter r2 ~c þ ~c ¼ c in Xd ð24Þ
where ~c is the ﬁltered design ﬁeld andrfilter is the ﬁlter parameter.
The following boundary conditions are used for the ﬁlter PDE:
~c ¼ 1o n @Xd nð Csymm [ CwallÞð 25Þ
n /C1 r~c ¼ 0o n Csymm [ Cwall ð26Þ
To reduce the gray area between solid and ﬂuid which is inherently
introduced by the ﬁltering process, a smoothed heaviside projection
[41] is applied on the ﬁltered design ﬁeld:
/C22~c ¼ tanhðb gÞþ tanhðb ð~c /C0 gÞÞ
tanhðb gÞþ tanhðb ð1 /C0 gÞÞ ð27Þ
where /C22~c is the projected design ﬁeld,b is a parameter controlling
the projection steepness, andg is the projection threshold parame-
ter. It should be noted that the projected design ﬁeld becomes the
physical meaningful one in the interpolation functions (Eqs.(17)
and (18)) and the thermal convection-diffusion equation (Eq.(11)).
4. Implementation
The heat sink topology optimization models are implemented
in the commercial ﬁnite element software COMSOL Multiphysics
[42]. The ﬂuid problem (Eqs.(1) and (2)) is solved with COMSOL’s
CFD Module using a second order discretization for the velocity
ﬁeld and ﬁrst order discretization for the pressure. COMSOL’sHeat
Transfer Module is used to solve the thermal convection-diffusion
equation (Eqs. (10) and (11)) and the thermal diffusion problem
in the base plate (Eq. (12)) using second order elements forTf
due to the steep temperature gradients in the thermoﬂuid design
layer and ﬁrst order elements forTs. The ﬁlter PDE (Eq.(24))i s
implemented in the Coefﬁcient Form PDE Interface using a linear
discretization and the ﬁlter parameter is set to 1.5 times the max-
imum element size in the design domain. Triangular elements are
used for all PDEs and no stabilization scheme is applied as it was
found to slightly blur the sensitivities within COMSOL’s optimizer
when compared to a ﬁnite difference check. The parallel sparse
direct solver PARDISO[43] that is available in COMSOL is used to
solve the system of discretized ﬁnite element equations and segre-
gated solver steps are used for the ﬂuid problem, thermal problem,
and ﬁlter PDE. The optimization is conducted within COMSOL’s
Optimization Module which automatically solves the adjoint prob-
lem to provide sensitivities for the objective and constraint func-
tionals and the globally convergent version of the Method of
Moving Asymptotes (GCMMA) [44] is used as the optimization
method. A continuation approach[39,45] is applied on the convex-
ity parameters of the interpolation functions, b
a; bh; bk, and the
steepness parameter of the design projection,b. This is done to
ensure a more convex optimization problem in the beginning
and to consequently gradually increase the penalization of inter-
mediate densities as well as to increase the sharpness of the
solid–ﬂuid interface. The choice of the ﬁnal values of the conduc-
tivity and Brinkman interpolation convexity parameters,bk and
ba, is particularly important as they mainly determine whether
there will be areas with unphysical intermediate densities in the
ﬁnal design. This is due to the high conductivity difference
between heat sink metal and air which is used as coolant in this
work. This high conductivity difference can make thin features
with intermediate densities that have increased thermal conduc-
tivity compared to air but do not effectively prevent the ﬂuid from
ﬂowing through them advantageous. Thus, the values ofb
k and ba
need to ensure a strong penalization of intermediate densities
through fairly nonlinear interpolation functions. However, highly
nonlinear interpolation functions caused problems with numerical
stability during test optimizations. To mitigate this issue, the solid
conductivity in the xy-plane in the thermoﬂuid layer of the opti-
mization model is set to a value lower than in reality as stated in
Section 5.1. Further discussions regarding these aspects are pro-
vided in Sections5.1 and 5.2. The heuristically chosen continuation
strategies used to optimizemodel a and model b are indicated in
Table 1. These continuation strategies are conservative both in
Table 1
Values of optimization parameters and number of model evaluations during the continuation approach formodel a and model b .
Continuation step neval;model a neval;model b qa qk qh b
1 500 600 8 0.1 0.1 1
2 250 300 4 5 2 1.5
3 150 150 2 20 8 2
4 100 100 1 50 8 2.5
5, 6, 7, 8, 9 80 80 1 50 8 3, 4, 5, 6, 7
10 80 80 1 50 8 7
1078 J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088
terms of number of continuation steps and number of model eval-
uations in each step. A less conservative continuation strategy
could be used as well; however, with an increased risk of converg-
ing to poor local optima. Values of constant optimization parame-
ters and mesh parameters of the optimization models are provided
in Table 2. The corresponding ﬁnite element mesh has around
34,000 elements in the case ofmodel a and around 66,000 elements
in the case ofmodel b. The choice to implement this model in COM-
SOL has limited several modeling parameters such as the problem
size and ﬁltering techniques, which has led to a limitation in the
range of Reynolds numbers that could be modeled. However, the
COMSOL framework allows for faster implementation of various
modeling scenarios and materials and is therefore a useful tool
for topology optimization. Dedicated models for speciﬁc conditions
would allow for higher ﬂuid velocities, larger model dimensions,
and higher resolution of the problem at the cost of longer develop-
ment time.
5. Results and discussion
5.1. Problem setup
Within this work, the thermophysical properties of air are
assumed constant and evaluated at 20/C176C. The resulting values
are given inTable 3. A thermal conductivity of 400 W/(m K), which
corresponds to the conductivity of copper, is assumed in the heat
sink base plate. The high conductivity difference between copper
and air can cause issues with regards to grey area in the ﬁnal
design and numerical stability during the optimization as dis-
cussed in Section4. For this reason, the value ofC
k, which determi-
nes the solid conductivity in the xy-plane in the thermoﬂuid design
layer, is in both models set to lower thermal conductivities than
the thermal conductivity assumed in the heat sink base plate.
The chosen Ck value corresponds to a solid thermal conductivity
of 24 W/(m K) inmodel a and 0.072 W/(m K) inmodel b which
makes the latter a more academic model. It should be noted that
the Ck value chosen inmodel b , which is lower than the value used
in model a is not chosen due to problems with grey area or numer-
ical stability during the optimization but because of convergence
to only locally optimal topologies that were observed during pre-
liminary model b optimizations. This issue is further discussed in
Section 5.3 In themodel a pseudo 3D and full 3D validation models,
the thermal conductivity of the heat sink base plate is used in all
solid domains to assess the inﬂuence of the chosen lower value
of Ck in the optimization model. The abovementioned and other
constant model parameters used within this work are stated in
Table 4. As already stated in Section2.2.2, a uniform heat produc-
tion rate is assumed in the heat sink base plate in all studies pre-
sented in this work apart from the model presented in
Section 5.2.5 where hotspots are studied. Moreover, the base plate
thickness differs in Section5.2.5 from the value given inTable 4.
5.2. Results model a
Thermoﬂuid topology optimization problems are quite non-
convex and can easily converge to only locally optimal topologies
depending on the starting guess or initial design. Therefore, several
initial designs are used for each optimization in this work and only
the respective best performing design is presented. The initial
designs used for the optimization ofmodel a are shown inFig. 3.
For all model a optimizations presented in this work, the initial
designs (a)–(k) and a uniform initial density ﬁeld of value 0.8 are
used. The initial designs (a)–(c) can be interpreted as parallel ﬁn
heat sink when the periodic structure is considered. The asymme-
try of the designs (d)–(k) with regards to a horizontal line in the
center of the design domain is intended as this was found to yield
improved optimization results compared to designs that are sym-
metric with regards to this line. Note that only the initial designs
(g), (h), and (i) led to best performing ﬁnal designs in all optimiza-
tions conducted for this work; all other initial guesses led to only
locally optimal designs. Still, it is important to test various initial
topologies as it is not known a priori which one will yield the best
performing ﬁnal design in the different optimizations.
5.2.1. Analysis and discussion of optimized designs
An exemplary model a optimization result for a pressure drop
over the heat sink of 3 Pa with corresponding velocity magnitude
ﬁeld, temperature ﬁeld in the thermoﬂuid design layer, and tem-
perature ﬁeld in the metal base plate is shown inFig. 4. Four ﬁns
are formed within the design domain where the bottom left and
top right ﬁn are halved by the symmetry boundary. The two ﬁns
in the bottom part of the design domain reach the left boundary
and the two ﬁns in the upper part of the design domain reach
the right boundary so that the ﬁns are almost arranged diagonally
from the bottom left to the top right of the design domain. All ﬁns
have to some degree a streamlined shape except for the bottom left
ﬁn which is almost triangular. This ﬁn is probably shaped in this
way to ﬁt closely to the left boundary of the design domain and
a more streamlined ﬁn shape would probably occur if the design
domain reached further left. Maximum air velocities between the
ﬁns of around 2.5 m/s are reached and the majority of the air ﬂows
through the upper part of the design domain. The somewhat diag-
onal arrangement of the ﬁns results in a to some degree diagonal
air ﬂow from the top left to the bottom right of the design domain.
Moreover, it can be seen that the Brinkman penalization effectively
prevents air from ﬂowing through the ﬁns. The ﬁns are nearly
isothermal within the modeled plane which provides some justiﬁ-
cation for assuming a lower solid conductivity in the thermoﬂuid
plane compared to the original value in the metal base plate. A very
Table 2
Values of constant optimization and mesh parameters formodel a and model b .
Parameter Model a value Model b value
Da [–] 10/C0 5 10/C0 5
Max. element size inXd [mm] 1:33 /C2 10/C0 2 8:66 /C2 10/C0 3
Max. element size inXa [mm] 2:86 /C2 10/C0 2 1:63 /C2 10/C0 2
rfilter [mm] 2:00 /C2 10/C0 2 1:30 /C2 10/C0 2
Table 3
Constant thermophysical properties of air used
in this work.
Thermophysical property Value
cair [J/(kg K)] 1006
kair [W/(m K)] 0.024
lair [Pa s] 1:94 /C2 10/C0 5
qair [kg/m3] 1.204
Table 4
Constant parameters used in the heat sinkmodel a and model b .
Parameter Model a value Model b value
Ck [–] 1/1000 1/3
hf [W/(m2 K)] 50 50
hs [W/(m2 K)] 2 /C2 105 2 /C2 105
ks;base plate [W/(m K)] 400 400
_Qprod [W] 0.175 0.25
Tin [/C176C] 20 20
Dzbase plate [mm] 0.2 0.2
Dzchannel [mm] 8 8
J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088 1079
uniform temperature can be seen in the base plate with a maxi-
mum temperature difference in the plate of slightly less than 0.4 K.
Fig. 5shows the inﬂuence of the prescribed pressure drop over
the heat sink on the optimized designs. The pressure drop ranges
from 0.5 to 7 Pa so that the inﬂuence of increasing convection-
domination on the optimized topologies can be studied. Design
(a) consists of one ﬁn in the bottom left and a second ﬁn in the
top right of the design domain. Increasing the pressure drop to 1
Pa results in a changed topology with four ﬁns in a diagonal
arrangement similar to the one described above in the discussion
of Fig. 4. Compared to design (a), a smaller ﬁn at the bottom left
and a smaller ﬁn at the top right of the design domain are added.
Both smaller ﬁns are halved by the symmetry boundary. Increasing
the pressure drop further leads to the same topology; however, the
length and thickness of the ﬁns increases. The ﬁns in all presented
designs have streamlined shapes apart from the triangularly
shaped bottom left ﬁn in the designs (c)–(f). The shapes of the indi-
vidual ﬁns differ within the same design and between the designs
Fig. 3. Initial designs used formodel a (red is solid and blue is ﬂuid). The designs (a)–(k) as well as a uniform initial density ﬁeld of value 0.8 are used to generate themodel a
results presented in this study. (For interpretation of the references to colour in this ﬁgure legend, the reader is referred to the web version of thisarticle.)
Fig. 4. Exemplary model a design obtained for a pressure drop over the heat sink of 3 Pa where red corresponds to solid and blue to ﬂuid. Additionally, the corresponding
velocity ﬁeld, temperature ﬁeld in the thermoﬂuid design layer, and temperature ﬁeld in the metal base plate are shown. (For interpretation of the references to colour in this
ﬁgure legend, the reader is referred to the web version of this article.)
Fig. 5. Inﬂuence of prescribed pressure drop over heat sink on the optimized topology formodel a . The pressure drop takes the values 0.5 (a), 1 (b), 2 (c), 3 (d), 5 (e), and 7 Pa
(f).
1080 J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088
at different pressure drops. It is not possible to classify the ﬁn
shapes according to classical heat sink ﬁn shapes such as NACA air-
foil [46], dropform, ellipse or plate ﬁn as e.g. analyzed in[47,48]
but the topology optimized ﬁns show a similarity to these designs.
In general, the optimized structures tend to reduce overall pressure
drop by forming streamlined shapes and to increase contact dis-
tance between the ﬂuid and solid by forcing the ﬂuid to take a
slightly diagonal path across the heat sink. All designs have clearly
deﬁned solid features without intermediate density areas apart
from the thin band at the solid–ﬂuid interface which results from
the density ﬁltering. This means that the chosen values of interpo-
lation convexity parameters and solid conductivity in the ther-
moﬂuid design layer work well in preventing unphysical
intermediate density features in the analyzed pressure drop range.
Also the applied density ﬁlter mitigates problems with very thin
unpractical ﬁn features in the ﬁnal designs. However, only robust
topology optimization approaches[41,49] may prevent such fea-
tures reliably, but these are not considered in this study and have
not yet been applied to thermoﬂuid topology optimization.
5.2.2. Model validation and parametric studies
It is important to verify the topology optimization model for
several reasons: The accuracy of the solid ﬂuid representation
using a density ﬁeld with Brinkman penalization should be
assessed which can be done by replacing this modeling approach
with an explicit separate modeling of solid and ﬂuid domains
and a body-ﬁtted mesh resolving the physics in the thermal
boundary layer with high accuracy. Moreover, the threshold value
for the explicit solid ﬂuid boundary representation,/C22~
c ¼ 0:8, and
the assumption of a lower solid conductivity in the thermoﬂuid
design layer plane, i.e. the choice ofCk, should be validated. The
inﬂuence of these factors can be checked in a pseudo 3D validation
model which will subsequently be referred to as the 2D validation
model. Moreover, a full 3D validation model is used to quantify the
inﬂuence of the assumptions inherent to the pseudo 3D modeling
approach. These are the simpliﬁcation of a 3D thermoﬂuid problem
to the 2D thermoﬂuid design layer and the interpolation of the
simpliﬁed heat transfer coupling between the 2D base plate model
and the thermoﬂuid design layer, i.e. the choice of the parameters
hf and hs. These effects are captured explicitly in the 3D model as
convective heat transfer from the base plate to the ﬂuid and con-
ductive heat transport from the base plate into the heat sink ﬁns.
Furthermore, the drag force from the top and bottom model
boundary on the air ﬂow is captured in the 3D model while it is
not considered in the 2D approach.
Fig. 6 shows the 3D boundary layer mesh for the optimized
design shown inFig. 4 and the corresponding 3D velocity magni-
tude ﬁeld and temperature ﬁeld. The mesh consists of approxi-
mately 403,000 elements in total and is shown on the ﬁn and
base plate surface as well as on the bottom wall and left symmetry
boundary of the channel. The 2D assumption in the optimization
model seems to be well justiﬁed for the ﬂuid problem as the ﬂow
shows very little variation along the z-coordinate apart from a
small hydraulic boundary layer near the top and bottom walls.
The z-dependency of the temperature ﬁeld is slightly more pro-
nounced as there is a temperature drop of around 8/C176C along the
ﬁns in addition to a thermal boundary layer above the base plate.
Nevertheless, the 2D thermoﬂuid design layer assumption seems
to be justiﬁed as an approximation. The temperature drop in the
ﬁns of around 8/C176C predicted by the 3D model agrees well with
the around 4/C176C temperature difference between the ﬁns in the
thermoﬂuid design layer and the base plate which can be seen in
the corresponding pseudo 3D model results shown inFig. 4 as
the ﬁn temperature in the pseudo 3D model can be interpreted
as an averaged temperature along the height of the ﬁns. Hence,
the value of the pseudo 3D model parameterhs, which represents
the conductive thermal resistance along the z-coordinate in the
ﬁns, yields good results for the presented case.
To provide a more quantitative means of evaluating the agree-
ment between the optimization model and the 2D and 3D valida-
tion model, the heat sink thermal resistance and Reynolds
number are compared over a pressure drop range from 0.5 Pa to
7 Pa which is shown inFig. 7. Note that all quantitativemodel a
results presented in the following are obtained by evaluating the
model with a projection steepness parameter of b ¼ 15 even
though b is only ramped up to a value of 7 during the optimization
as shown inTable 1. The higherb value used for the ﬁnal model
evaluation yields a better solid-ﬂuid thresholding and hence min-
imizes the effect of grey area in the design. To be consistent, also
the contours of themodel a 2D and 3D validation models are gen-
erated using a projection steepness parameter value of 15. Further-
more, it should be noted that the value of the thermal resistance in
this model is more of a relative measure as it depends on the heat
input into the base plate which is proportional to the size of the
modeled area within the periodic heat sink structure. The Reynolds
number is computed with the average velocity at the inlet as char-
acteristic velocity and inlet width as characteristic length since a
characteristic length based on the ﬁn geometry can differ signiﬁ-
cantly between the different designs. The Reynolds number
increases almost linearly with increasing pressure drop over the
heat sink. At a 0.5 Pa pressure drop, the Reynolds number is around
30 and the highest Reynolds number at 7 Pa pressure drop is
around 200 both in the optimization model and the 2D validation
model and around 170 in the 3D validation model. These values are
well below the critical Reynolds number for laminar turbulent
transition that is for ﬂow between parallel plates, which can be
used as simpliﬁed reference geometry for the ﬂow between the
ﬁns, reported to be slightly below 2300[50]. Hence, assuming a
laminar ﬂow seems to be valid even though an additional experi-
mental validation of the ﬂow conditions should be conducted
which is left for future works.1 The optimization model and 2D val-
idation model show good agreement in terms of predicted Reynolds
number where the 2D validation model consistently predicts slightly
lower values. This deviation is assumed to be mainly due to the
implicit boundary representation between solid and ﬂuid used in
the optimization and slight ﬂuid leakages through the solid domains
in the optimization model. The 3D validation model consistently
predicts the lowest Reynolds numbers which is owed to the wall
friction at the top and bottom boundaries of the modeled domain
which is not considered in the 2D optimization and 2D validation
model. The relative offset in terms of Reynolds number between
the optimization model and the 3D validation model increases with
increasing pressure drop from around 12% at
Dp ¼ 0:5 Pa to around
17% at Dp ¼ 7 Pa. A decrease of thermal resistance with increasing
pressure drop over the heat sink can be observed as expected. This
effect is signiﬁcantly more pronounced for lower pressure drops;
for higher pressure drops, an increase of pressure drop leads to a
small further decrease in thermal resistance. A good agreement
between the optimization model and both validation models can
1 As mentioned in the introduction and shown in[16], fabrication of topology
optimized designs using additive manufacturing techniques may have great potential
due to the design freedom that these methods provide. However, it should be noted
that the dimensions of the design domains treated in this work are in the millimeter
to submillimeter range which are presently more suited to micromachining or
conventional chemical etching techniques than most mature additive manufacturing
techniques. These dimensions were chosen due to the limitation to low Reynolds
numbers of the COMSOL modeling framework. Achieving low Reynolds numbers in
models with larger model dimensions would have only been possible at the trade-off
of unrealistically low ﬂuid velocities. Generally, treatment of higher Reynolds number
problems and larger model dimensions is possible in more customizable and
computationally efﬁcient frameworks than COMSOL.
J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088 1081
be seen over the entire pressure drop range which provides some
justiﬁcation for the validity of the assumptions made in the opti-
mization model. Over the entire pressure drop range, the optimiza-
tion model consistently predicts the lowest and the 3D validation
model the highest thermal resistance. The main reason for this is
presumably the difference in Reynolds numbers between the mod-
els. A higher Reynolds number is equivalent to a higher coolant ﬂow
rate and hence better cooling performance. Thus, the 3D validation
model, which predicts the lowest Reynolds numbers, yields the high-
est thermal resistance and the optimization model, which predicts
the highest Reynolds numbers, yields the lowest thermal resistance.
A cross-check of themodel a optimized geometries based on the
2D validation model is stated inTable 5. Each design optimized for
a respective pressure drop of 0.5, 1, 2, 3, 4, and 5 Pa is tested at
each of the other pressure drop values. Ideally, each design should
perform best at the pressure drop for which it is optimized, and
this is the case as can be seen fromTable 5. Furthermore, it can
be seen that the performance differs for lower pressure drops con-
siderably more between the designs than for higher pressure
drops.
5.2.3. Benchmarking to size optimized parallel ﬁn designs
Cross-checking the optimization results is important as poor
local optima within the generated designs can be identiﬁed. Never-
theless, it is limited in the sense that the designs are only com-
pared within the optimized set and, therefore, it is of interest to
benchmark the performance of the topology optimized designs to
a conventional heat sink geometry. In this case, a size-optimized
parallel ﬁn design is chosen as the reference geometry. All ﬁns have
Fig. 6. Mesh used in the 3D body-ﬁtted mesh validation model of the optimizedmodel a geometry shown inFig. 4with corresponding velocity and temperature ﬁeld.
01234567
Pressure drop [Pa]
50
100
150
200
250
300
350
400Heat sink thermal resistance [K/W]
Optimization model
2D validation model
3D validation model
01234567
Pressure drop [Pa]
20
40
60
80
100
120
140
160
180
200
220Reynolds number [-]
Optimization model
2D validation model
3D validation model
Fig. 7. Inﬂuence of pressure drop over the heat sink on the heat sink heat transfer resistance as deﬁned in Eq.(21) (left) and the Reynolds number of the optimized designs
(right). Results are shown for themodel a optimization model, the corresponding 2D body-ﬁtted mesh validation model, and 3D body-ﬁtted mesh validation model.
1082 J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088
the same thickness,thfin, which is the optimization variable. Opti-
mal ﬁn thicknesses are determined exemplarily for a pressure drop
of 2 Pa and for 1, 1.5, 2, and 2.5 ﬁns within the design domain. The
ﬁns are spaced relative to each other such that the resulting peri-
odic structure has a uniform distance between the ﬁns. The size
optimization is conducted for a projection steepness parameter
b ¼ 7 to allow for a fair comparison to the topology optimization
as b ¼ 7 is the last value of the continuation scheme used in this
work. Table 6 shows the optimal ﬁn thickness for the different
numbers of ﬁns within the design domain and the respective ther-
mal resistance. Moreover, the thermal resistance of the corre-
sponding topology optimized design is shown. It can be seen that
the optimal ﬁn thickness decreases with increasing number of ﬁns
within the modeled domain as expected. The design with two ﬁns
performs best among the size optimized designs having a thermal
resistance of 184.5 K/W for the optimal ﬁn thickness of 0.06 mm.
Still, the topology optimized design for the same pressure drop
has a lower thermal resistance of 168.0 K/W which is a relative
improvement of 9.8% compared to the best size optimized design.
Fig. 8shows the best performing size optimized design and the
topology optimized design to which it is compared. It can be seen
that the ﬁns of the topology optimized design are not as thin as the
ﬁns of the size optimized design which is advantageous for
mechanical stability. Moreover, the topology optimized design
may be more robust with regards to manufacturing uncertainty
as the performance of parallel ﬁn heat sinks and heat exchangers
is sensitive to ﬂow maldistribution caused by small differences of
geometry between the channels[51]. However, these aspects need
to be assessed and quantiﬁed in future works. A second exemplary
benchmarking of a topology optimized design to a size optimized
parallel ﬁn design is presented in Section5.2.5 for a non-uniform
heat generation rate in the base plate.
5.2.4. Comparison to pressure drop minimization
The optimized heat sink ﬁns depicted inFig. 5have a relatively
streamlined shape as already mentioned above. Therefore, it is of
interest to compare the shape of ﬁns optimized with regard to
thermal resistance minimization and ﬁns of the same cross-
sectional area optimized with regard to pressure drop minimiza-
tion. For a better comparison of the shapes, the same initial design
which is generated with thermal resistance minimization objective
without volume constraint is used for all optimizations within this
section. This design is then used to initialize thermal resistance and
pressure drop optimizations with active volume constraint that
can be directly compared to each other. Moreover, the air inlet
velocity in all pressure drop minimizations is set such that the Rey-
nolds number is the same as in the thermal resistance minimiza-
tion design without a volume constraint. This initial design and
the designs optimized with volume constraints between 19.3%
and 5% are shown inFig. 9. The design obtained by thermal resis-
tance minimization without volume constraint consists of a single
thin ﬁn stretching across the entire length of the design domain
which could be interpreted as a plate ﬁn heat exchanger when con-
sidering the periodic structure. The ﬁn is slightly streamlined with
a blunt front and rear end where the ﬁn reaches the respective end
of the design domain. A similarly shaped ﬁn stretching over the
entire length of the design domain is generated forf ¼ 15% and
f ¼ 10%; however, it is becoming increasingly thinner. For
f ¼ 5%, two very thin ﬁns with slightly streamlined front and rear
end are formed at the position of the single longer ﬁn in the previ-
ous designs. The design obtained by pressure drop minimization
for f ¼ 19:3% stretches over the entire length of the design domain
as the thermal resistance minimized design at the samef value.
However, the pressure drop minimized design resembles more a
mix of ﬂat ellipse and NACA shape apart from the blunt front
and rear end where the ﬁn reaches the respective end of the design
domain. The ﬁn shape is the same for decreasingf values but its
length decreases with decreasingf so that the ﬁns do not have a
blunt ends forf ¼ 15% and lower. The comparable problem of opti-
mal 2D cross-sections for drag minimization in laminar Navier-
Stokes ﬂow has been treated in the literature by using variational
methods of optimal control[52], by numerical solution of the 2D
Navier-Stokes and adjoint problem where the latter provides ﬁrst
and second order necessary conditions for a shape with minimal
drag [53], and using density-based topology optimization in a
ﬁnite element framework[54]. Pironneau[52] concludes that the
optimal shape has a 90/C176wedge shape at the front end and[53] pre-
sent slender, close to ellipsoid optimal proﬁles with wedge shaped
front and rear end for Reynolds numbers between 1 and 40. Kon-
doh et al.[54] study the problem for Reynolds numbers of up to
2000 ﬁnding similar optimized proﬁles as[53] for lower Reynolds
numbers and, for higher laminar Reynolds numbers, shapes very
similar to the pressure drop minimized designs with f 6 15%
depicted in Fig. 9. A smoother front and rear end of the proﬁles
is the main difference to the more wedge shaped front and rear
ends presented in[54]. The smoother shapes obtained in this study
are most probably due to the density ﬁltering that smears out ﬁne
features which was not applied in[54].
The objective function values for thermal resistance and pres-
sure drop minimization of the designs shown inFig. 9 are given
in Table 7. Considering the thermal resistance objective, it can be
seen that the thermal resistance increases with decreasing volume
constraint values from 225 K/W atf ¼ 19:3% to 282 K/W atf ¼ 5%
as the cross-sectional area for heat transfer from the base plate into
the ﬁn and the contact area between ﬁn and airﬂow decrease. An
even stronger increase in thermal resistance with decreasing
Table 5
Cross-check ofmodel a optimized designs heat transfer resistance [K/W] based on the 2D body-ﬁtted mesh validation model.
Design forDp [Pa] Dp [Pa] tested for
0 . 512345
0.5 345.8 260.3 205.3 180.5 165.1 154.3
1 375.5 245.1 180.8 155.9 141.2 131.0
2 439.2 257.8 175.1 146.4 130.3 119.4
3 494.1 277.0 177.6 144.6 126.8 115.0
4 538.5 294.7 182.2 145.5 126.2 113.7
5 595.9 319.8 191.1 149.1 127.5 113.6
Table 6
Thermal resistance of the size optimized parallel ﬁn heat sink designs and topology
optimized (TO) design for a pressure drop of 2 Pa. Furthermore, the optimal ﬁn
thickness is stated for the parallel ﬁn designs.
Design Optimal thfin [mm] Rth [K/W]
1 ﬁn 0.23 250.6
1.5 ﬁn 0.11 189.6
2 ﬁn 0.06 184.5
2.5 ﬁn 0.05 218.3
TO design – 168.0
J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088 1083
volume constraint values from 226 K/W atf ¼ 19:3% to 387 K/W
at f ¼ 5% occurs for the pressure drop minimization objective as
these designs have less contact area between ﬁn and ﬂuid as those
of the thermal resistance minimization for the samef value. The
pressure drop decreases signiﬁcantly with decreasing f for the
pressure drop minimization from 2.95 Pa atf ¼ 19:3% to 1.28 Pa
at f ¼ 5%. Comparing both optimization objectives for the same
f, it can be seen that the differences both in thermal resistance
and pressure drop increase with decreasingf. For f ¼ 19:3%, the
relative difference in thermal resistance is 0.3% and the relative
difference in pressure drop 1.7%. However, much larger differences
would be observed when comparing designs where several ﬁns are
advantageous from a thermal point of view as a single ﬁn is always
advantageous for the pressure drop minimization objective.
5.2.5. Non-uniform heat production rate in the base plate
In the studies presented above, a uniform heat production rate
in the heat sink base plate is considered and a thermal conductivity
of 400 W/(m K) is assumed in the base plate which is at the higher
side of the thermal conductivities of metals and alloys commonly
used in heat sinks. Moreover, air is considered as the coolant which
limits the heat ﬂux magnitude that can be rejected by the heat sink
compared to other coolants as, for example, water. These factors
lead to relatively uniform base plate temperatures that could be
well approximated using a lumped model for the base plate, i.e.
relying on a pure 2D optimization model instead of the presented
pseudo 3D approach which captures the thermal diffusion problem
in the base plate. Therefore, a model with non-uniform heat pro-
duction rate in the base plate and reduced base plate thickness that
leads to thermal hotspots is introduced in this section to demon-
strate the added value of the pseudo 3D optimization model. The
base plate thickness considered in this section is 0.005 mm and
the same total heat production in the base plate as in the studies
above is assumed; however, the heat is only released in one circu-
lar area in the bottom left and one circular area in the top right part
of the design domain. An exemplary topology optimization using
this model is conducted for a pressure drop of 2 Pa and the opti-
mized design and the corresponding velocity magnitude, design
layer temperature, and base plate temperature are shown in
Fig. 10. The areas where the heat generation in the base plate
occurs are marked with yellow circles. The resulting design con-
sists of three ﬁns which is a different topology than the corre-
sponding 2 Pa design for a uniform base plate heat production
rate (seeFig. 5c) that comprises 4 ﬁns. Moreover, an optimization
for this pressure drop is conducted for comparison using an opti-
mization model with a lumped model for the heat sink base plate,
i.e. assuming a spatially non-varying base plate temperature. This
optimization results in a topology comprising 4 ﬁns similar to
the design shown inFig. 5c which is not surprising as the base
plate temperature only varies by around 0.4/C176C in the case of uni-
form heat generation. In the case of non-uniform heat generation
in the base plate, the topology with three ﬁns is advantageous
since the top and bottom ﬁns can be placed directly on the respec-
tive area of heat generation and hence effectively dissipate the heat
Fig. 8. Size optimized 2 ﬁn design (a) and topology optimized design (b) for a pressure drop of 2 Pa.
Fig. 9. Comparison of thermal resistance minimization and pressure drop minimization formodel a . The top left design is generated without volume constraint and used as
initial design for all other optimizations shown in this ﬁgure which are conducted with active constraint on the fraction of solid volume in the designdomain.
Table 7
Comparison of thermal resistance minimization and pressure drop minimization objective function values for different volume constraints usingmodel a .
f [%] Rth min. objective Dp min. objective
Rth [K/W] Dp [Pa] Re [–] Rth [K/W] Dp [Pa] Re [–]
19.3 225.4 3.00 115 226.1 2.95 115
15 226.5 3.00 131 244.0 2.45 115
10 234.6 3.00 152 289.3 1.87 115
5 282.0 3.00 173 387.3 1.28 115
1084 J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088
from there. For this reason, the bottom and top ﬁn have an around
10 /C176C higher temperature than the middle ﬁn. The highest temper-
atures in the base plate occur around the areas of heat generation
even though ﬁns are placed above these areas to remove the heat.
A temperature difference of 15/C176C occurs between the hotspots and
the coldest part of the base plate which is below the middle ﬁn.
Comparing the heat sink thermal resistances realized by the differ-
ent optimization models, it is interesting to note that the non-
uniform heat generation design has a thermal resistance of
164.6 K/W which is slightly lower than the thermal resistance of
168.0 K/W realized by the uniform heat generation model and
167.3 K/W realized by the lumped base plate model. This shows
that the topology optimization can make use of the increased hot-
spot temperatures and remove the heat more efﬁciently than in the
case of an isothermal or almost isothermal base plate which pro-
vides some conﬁrmation of the usefulness of explicitly modeling
the thermal diffusion in the base plate in the optimization model.
As presented in Section5.2.3 for the case of uniform heat gen-
eration in the base plate, a comparison to a size optimized parallel
heat sink is conducted. Also in this case 1 ﬁn, 1.5 ﬁns, 2 ﬁns, and 2.5
ﬁns within the design domain, spaced such that the ﬁns have a uni-
form distance in the periodic structure, are considered. Further-
more, a design with 2 ﬁns is optimized where the ﬁns are spaced
such that the ﬁn center coincides with the center of the circular
areas of heat input which results in a slightly irregular ﬁn pattern
when considering the periodic ﬁn structure. For each of these
cases, the optimal ﬁn thickness is determined and the resulting
ﬁn thickness and thermal resistances of these size optimized
designs and the topology optimized design are provided inTable 8.
The design2 ﬁn (a) refers to the design with 2 ﬁns and a uniform
ﬁn spacing in the periodic structure and the design2 ﬁn (b) refers
to the design with 2 ﬁns where the center of the respective ﬁn
coincides with the center of the respective circular area of heat
input. As in the case of uniform heat production rate in the base
plate, the design with 2 ﬁns and uniform ﬁn spacing in the periodic
structure has the lowest thermal resistance. A slightly higher ther-
mal resistance is realized by the design2 ﬁn (b) which shows that
equal ﬂow distribution between the parallel ﬁns is more important
for the overall thermal performance than an exact placing of the
ﬁns above the areas of heat input. The topology optimized design
has a lower thermal resistance than the best size optimized design.
In this case, a relative thermal resistance reduction of 13.6% is
afforded by the topology optimization.
5.3. Results model b
As mentioned in Section2.1, themodel b geometry is included
in this work to generate more complex topologies than those
obtained formodel a and to demonstrate a case where the number
of ﬁns in the optimized designs varies for different pressure drops
over the heat sink. Only a uniform heat production rate in the base
plate is considered for themodel b optimizations. A uniform design
ﬁeld with
c ¼ 0:8 and a straight ﬂuid channel between inlet and
outlet are used as initial designs formodel b of which the boundary
conditions and dimensions are shown inFig. 2. Hence, fewer initial
guesses are used as in themodel a optimizations. For this reason, a
design continuation approach between the different pressure
drops optimized for is applied in themodel b optimizations. This
means that the optimal design at a certain pressure drop is used
as an additional initial design for the next higher and lower pres-
sure drops. As stated in Section5.1, a lower solid conductivity in
the xy-plane in the thermoﬂuid design layer, i.e.Ck value, was cho-
sen inmodel b compared tomodel a. This is done to avoid problems
with convergence to poor local optima that were observed during
preliminary model b optimizations. More speciﬁcally, convergence
to designs with fewer ﬁns than optimal were observed when using
the same Ck value as inmodel a . This issue can be avoided when
Fig. 10. Topology optimizedmodel a design obtained for a non-uniform heat production rate in the base plate and a pressure drop over the heat sink of 2 Pa. Red corresponds
to solid, blue to ﬂuid and the areas where the heat input into the base plate occurs are marked by yellow circles. Additionally, the corresponding velocity ﬁeld, temperature
ﬁeld in the thermoﬂuid design layer, and temperature ﬁeld in the metal base plate are shown. (For interpretation of the references to colour in this ﬁgure legend, the reader is
referred to the web version of this article.)
Table 8
Thermal resistance of size optimized parallel ﬁn heat sink designs and the topology
optimized design for a pressure drop of 2 Pa and a non-uniform heat ﬂux in the base
plate. Furthermore, the optimal ﬁn thickness is stated for the parallel ﬁn designs.
Design Optimal thfin [mm] Rth [K/W]
1 ﬁn 0.25 267.6
1.5 ﬁn 0.11 197.3
2 ﬁn (a) 0.07 187.0
2 ﬁn (b) 0.07 190.1
2.5 ﬁn 0.05 220.6
TO design – 164.6
J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088 1085
using the presented approach with a loweredCk value and design
continuation between different pressure drops; however, the low-
ered C
k value leads to a more academic optimization model. The
effect of this assumption can be quantiﬁed by comparing the pre-
dicted thermal resistance of a pseudo 3D body-ﬁtted mesh valida-
tion model with a solid conductivity in the ﬁns corresponding to
the conductivity of copper to the thermal resistance of the opti-
mization model as done formodel a . However, this comparison is
omitted for model b as this model serves mainly to demonstrate
the capabilities of the topology optimization method to generate
more complex designs. The unphysically lowCk value in the opti-
mization model may possibly also be avoided by other means such
as ramping theCk value during the optimization or using different
initial designs with several ﬁns as presented formodel a but both of
these approaches are not considered formodel b in this work. An
exemplary optimizedmodel b design forDp ¼ 20 Pa with the corre-
sponding ﬂuid velocity magnitude and streamlines, thermoﬂuid
design layer temperature, and base plate temperature is depicted
in Fig. 11. The design consists of three ﬁns at the bottom, left,
and right boundary of the design domain, where a no slip condition
is imposed. Four more ﬁns are formed in the middle of the design
domain with small channels between them and one larger channel
between the uppermost ﬁn and the symmetry boundary at the top
of the design domain. The maximum temperature in the ﬁns is
around 51 /C176C, and it can be seen that the ﬁns are not entirely
isothermal in the modeled plane due to the relatively low solid
conductivity assumed in model b within the thermoﬂuid design
layer. The metal base plate is fairly isothermal with the tempera-
ture ranging between 51.9/C176C and almost 52.4/C176C.
Fig. 12shows optimizedmodel b topologies with respect to the
pressure drop over the heat sink where pressure drops between 1
and 20 Pa are considered. The general design is the same in all
cases. Three ﬁns are formed at the bottom, left, and right side of
the design domain where a no slip condition is imposed. Addition-
ally, a number of ﬁns are formed in the middle of the design
domain: One ﬁn for
Dp ¼ 1 Pa, two ﬁns for 2.5 Pa, 3 ﬁns for 7.5
Pa, and 4 ﬁns for 20 Pa. The Reynolds number of the optimized
designs deﬁned with regards to the average inlet velocity and inlet
width as characteristic length range between 7.2 forDp ¼ 1 Pa and
67.0 forDp ¼ 20 Pa. Hence, the laminar ﬂow assumption seems to
be also well justiﬁed formodel b .
A cross-check of the objective function values of the optimized
designs shown inFig. 12 based on a pseudo 3D body-ﬁtted mesh
validation model is stated inTable 9. The solid–ﬂuid interface is
thresholded at /C22~c ¼ 0:8 as it is done inmodel a and the heat sink
thermal resistance is computed with two times the heat produc-
tion rate stated inTable 4to represent the entire heat sink of which
only the bottom half is optimized due to the assumed symmetry
Fig. 11. Exemplary model b design obtained for a pressure drop over the heat sink of 20 Pa where red corresponds to solid and blue to ﬂuid. Moreover, the corresponding
velocity ﬁeld, temperature ﬁeld in the thermoﬂuid design layer, and temperature ﬁeld in the metal base plate are shown. (For interpretation of the references to colour in this
ﬁgure legend, the reader is referred to the web version of this article.)
Fig. 12. Inﬂuence of pressure drop overmodel b heat sink on optimized designs. Red corresponds to solid and blue to ﬂuid. The pressure drop takes the values 1 (a), 2.5 (b), 7.5
(c), and 20 Pa (d). (For interpretation of the references to colour in this ﬁgure legend, the reader is referred to the web version of this article.)
1086 J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088
boundary condition at the top of the design domain. Moreover, the
conductivity of copper is set in the solid domains of the ther-
moﬂuid design layer to provide a more realistic validation model.
Each design performs best at the pressure drop for which it is opti-
mized, which provides some conﬁrmation of the validity of these
results from an optimization point of view. It also shows that the
presented optimization with loweredCk value may be interpreted
as a more heuristic optimization that still yields useful designs
when evaluated under more realistic conditions.
6. Conclusions
In this work, a thermoﬂuid topology optimization model
assuming steady state laminar ﬂow is applied to the design of
forced convection air-cooled heat sinks. To reduce the computa-
tional effort that is associated with a 3D optimization model, a
pseudo 3D heat sink model comprised of a 2D modeled heat sink
base plate and 2D modeled thermoﬂuid design layer that are ther-
mally coupled is used. Heat sink designs being periodic perpendic-
ular to the ﬂow direction are generated using symmetry conditions
at the sides of the modeled domain. The optimization objective is
to minimize the heat sink heat transfer resistance for a prescribed
pressure drop over the heat sink and prescribed heat production
rate in the base plate. Optimized designs are presented and dis-
cussed from a thermal engineering point of view. Parametric stud-
ies are conducted to analyze the inﬂuence of the prescribed
pressure drop on the optimized topologies as well as on Reynolds
number and thermal resistance of the system. To assess the inﬂu-
ence of the implicit solid-ﬂuid boundary representation in density-
based topology optimization, 2D and 3D validation simulations
with explicit representation of the solid-ﬂuid boundary and a
body-ﬁtted mesh are conducted. Moreover, the 3D validation
model is used to check the validity of the heat sink representation
in the presented pseudo 3D model. A good agreement between the
models in terms of predicted thermal resistance and Reynolds
number is found over the entire analyzed pressure drop range
and reasons for deviations between the models are discussed. It
is found that the 3D thermoﬂuid problem of the airﬂow around
the heat sink ﬁns can be approximated as a 2D problem in the ana-
lyzed case. Still, the pseudo 3D optimization model can also be use-
ful in cases of more pronounced three-dimensional physical
phenomena to provide promising starting guesses for a subsequent
full 3D optimization. Another means to deal with more pro-
nounced 3D physical phenomena is to add further thermoﬂuid lay-
ers to the pseudo 3D model. However, this is non-trivial even if
only ﬁn cross-sections being constant in z-direction are consid-
ered. This is mainly because assumptions for the heat exchange
between the layers, both for ﬂuid-ﬂuid and ﬁn-ﬁn heat transfer,
need to be made. Further assumptions would be needed if also
momentum transfer between the layers was considered. Moreover,
the computational burden increases signiﬁcantly with each added
thermoﬂuid layer. The complexity increases even more if the ﬁn
cross-sections are allowed to differ between the layers since a dif-
ferent 2D design variable ﬁeld is then needed to be introduced for
each thermoﬂuid layer. For these reasons, the analysis of pseudo
3D heat sink models with several thermoﬂuid layers is left for
future works. A cross-check based on the 2D validation model
shows that each design performs best at the pressure drop opti-
mized for. Furthermore, two exemplary topology optimized
designs are benchmarked to a size optimized parallel ﬁn heat sink
to provide a comparison to a conventional heat sink geometry. A
thermal resistance reduction of up to 13.6% is found to be afforded
by the topology optimization which provides some conﬁrmation
for the added beneﬁt of topology optimization. Fins generated with
thermal resistance minimization as optimization objective are
compared to pressure drop minimized ﬁns for given volume con-
straints in terms of resulting ﬁn shape, thermal resistance, and
pressure drop. Moreover, an exemplary topology optimization is
conducted for a model with heat generation in two local thermal
hotspots in the base plate. This optimization results in a different
topology and slightly lower thermal resistance than in the case
of a uniform or an almost uniform base plate temperature which
demonstrates the usefulness of including the thermal diffusion
problem in the base plate in the optimization model. A second
non-periodic and more academic, heat sink model with inlet and
outlet width smaller than the design domain width is optimized
to generate more complex and topologically more interesting ﬁn
designs. Optimization results for different pressure drops are pre-
sented and discussed and a cross-check based on a 2D body-
ﬁtted mesh validation model conﬁrms the optimization technique.
Conﬂict of interest
The authors declare that there is no conﬂict of interest.
Acknowledgements
This work was supported by the TOpTEn project sponsored
through the Sapere Aude Program of the Danish Council for Inde-
pendent Research (DFF 4005-00320).
Moreover, the authors wish to thank Rasmus Bjørk for helping
to run COMSOL/MATLAB on a computer cluster and Niels Aage
and Casper Schousboe Andreasen for their helpful advice with
regards to the topology optimization implementation in COMSOL.
References
[1] S.V. Garimella, A.S. Fleischer, J.Y. Murthy, A. Keshavarzi, R. Prasher, C. Patel, S.H.
Bhavnani, R. Venkatasubramanian, R. Mahajan, Y. Joshi, et al., Thermal
challenges in next-generation electronic systems, IEEE Trans. Compon. Pack.
Technol. 31 (4) (2008) 801–815,https://doi.org/10.1109/TCAPT.2008.2001197.
[2]
A. Vassighi, M. Sachdev, Thermal and Power Management of Integrated
Circuits, Springer Science & Business Media, 2006.
[3] A.M. Adham, N. Mohd-Ghazali, R. Ahmad, Thermal and hydrodynamic analysis
of microchannel heat sinks: a review, Renew. Sustain. Energy Rev. 21 (2013)
614–622, https://doi.org/10.1016/j.rser.2013.01.022.
[4]
A.D. Kraus, A. Bar-Cohen, Thermal Analysis and Control of Electronic
Equipment, Hemisphere Publishing Corp., Washington, DC, 1983, p. 633.
[5] S. Lee, Optimum design and selection of heat sinks, in: Semiconductor Thermal
Measurement and Management Symposium, 1995, SEMI-THERM XI, Eleventh
Annual IEEE, IEEE, 1995, pp. 48–54, https://doi.org/10.1109/
STHERM.1995.512051.
[6] K. Park, P.-K. Oh, H.-J. Lim, The application of the CFD and Kriging method to an
optimization of heat sink, Int. J. Heat Mass Transf. 49 (19) (2006) 3439–3447,
https://doi.org/10.1016/j.ijheatmasstransfer.2006.03.009.
[7] M.P. Bendsoe, O. Sigmund, Topology Optimization: Theory, Methods, and
Applications, Springer, 2003,https://doi.org/10.1007/978-3-662-05086-6.
[8] J.D. Deaton, R.V. Grandhi, A survey of structural and multidisciplinary
continuum topology optimization: post 2000, Struct. Multidiscip. Optimiz.
49 (1) (2014) 1–38,https://doi.org/10.1007/s00158-013-0956-z.
[9] T. Dbouk, A review about the engineering design of optimal heat transfer
systems using topology optimization, Appl. Therm. Eng. 112 (2016) 841–854,
https://doi.org/10.1016/j.applthermaleng.2016.10.134.
[10] O. Sigmund, Design of multiphysics actuators using topology optimization –
Part I: One-material structures, Comput. Methods Appl. Mech. Eng. 190 (49)
(2001) 6577–6604,https://doi.org/10.1016/s0045-7825(01)00251-1.
Table 9
Discrete cross-check of model b optimized designs heat transfer resistance [K/W]
based on the pseudo 3D body-ﬁtted mesh validation model.
Design forDp [Pa] Dp [Pa] tested for
1 2.5 7.5 20
1 751.4 317.8 203.1 151.4
2.5 871.5 288.5 129.6 98.2
7.5 1216.7 360.0 119.9 64.9
20 1909.9 525.0 150.5 64.1
J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088 1087
[11] L. Yin, G.K. Ananthasuresh, A novel topology design scheme for the multi-
physics problems of electro-thermally actuated compliant micromechanisms,
Sens. Actuat. A: Phys. 97 (2002) 599–609,https://doi.org/10.1007/978-3-642-
59497-7_59.
[12] T.E. Bruns, Topology optimization of convection-dominated, steady-state heat
transfer problems, Int. J. Heat Mass Transf. 50 (15) (2007) 2859–2873,https://
doi.org/10.1016/j.ijheatmasstransfer.2007.01.039.
[13] A. Iga, S. Nishiwaki, K. Izui, M. Yoshimura, Topology optimization for thermal
conductors considering design-dependent effects, including heat conduction
and convection, Int. J. Heat Mass Transf. 52 (11) (2009) 2721–2732,https://doi.
org/10.1016/j.ijheatmasstransfer.2008.12.013.
[14] S.-H. Ahn, S. Cho, Level set-based topological shape optimization of heat
conduction problems considering design-dependent convection boundary,
Numer. Heat Transf. Part B: Fundam. 58 (5) (2010) 304–322,https://doi.org/
10.1080/10407790.2010.522869.
[15] Y. Joo, I. Lee, S.J. Kim, Topology optimization of heat sinks in natural convection
considering the effect of shape-dependent heat transfer coefﬁcient, Int. J. Heat
Mass Transf. 109 (2017) 123–133, https://doi.org/10.1016/j.
ijheatmasstransfer.2017.01.099.
[16] E.M. Dede, S.N. Joshi, F. Zhou, Topology optimization, additive layer
manufacturing, and experimental testing of an air-cooled heat sink, J. Mech.
Des. 137 (11) (2015) 111702,https://doi.org/10.1115/1.4030989.
[17] M. Zhou, J. Alexandersen, O. Sigmund, C.B. Pedersen, Industrial application of
topology optimization for combined conductive and convective heat transfer
problems, Struct. Multidiscip. Optimiz. 54 (4) (2016) 1045–1060,https://doi.
org/10.1007/s00158-016-1433-2.
[18] P. Cofﬁn, K. Maute, Level set topology optimization of cooling and heating
devices using a simpliﬁed convection model, Struct. Multidiscip. Optimiz. 53
(5) (2016) 985–1003,https://doi.org/10.1007/s00158-015-1343-8.
[19] S. Soprani, J.H.K. Haertel, B. Lazarov, O. Sigmund, K. Engelbrecht, A design
approach for integrating thermoelectric devices using topology optimization,
Appl. Energy 176 (2016) 49–64, https://doi.org/10.1016/j.
apenergy.2016.05.024.
[20] A. Pizzolato, A. Sharma, K. Maute, A. Sciacovelli, V. Verda, Topology
optimization for heat transfer enhancement in latent heat thermal energy
storage, Int. J. Heat Mass Transf. 113 (2017) 875–888,https://doi.org/10.1016/
j.ijheatmasstransfer.2017.05.098.
[21] E.M. Dede, Multiphysics topology optimization of heat transfer and ﬂuid ﬂow
systems, in: Proceedings of the COMSOL Users Conference, 2009.
[22] G.H. Yoon, Topological design of heat dissipating structure with forced
convective heat transfer, J. Mech. Sci. Technol. 24 (6) (2010) 1225–1233,
https://doi.org/10.1007/s12206-010-0328-1.
[23] E.M. Dede, Optimization and design of a multipass branching microchannel
heat sink for electronics cooling, J. Electron. Pack. 134 (4) (2012) 041001,
https://doi.org/10.1115/1.4007159.
[24] A.A. Koga, E.C.C. Lopes, H.F.V. Nova, C.R. de Lima, E.C.N. Silva, Development
of heat sink device by using topology optimization, Int. J. Heat Mass
Transf. 64 (2013) 759–772, https://doi.org/10.1016/j.ijheatmasstransfer.
2013.05.007.
[25] T. Matsumori, T. Kondoh, A. Kawamoto, T. Nomura, Topology optimization for
ﬂuid–thermal interaction problems under constant input power, Struct.
Multidiscip. Optimiz. 47 (4) (2013) 571–581, https://doi.org/10.1007/
s00158-013-0887-8.
[26] K. Yaji, T. Yamada, M. Yoshino, T. Matsumoto, K. Izui, S. Nishiwaki, Topology
optimization in thermal-ﬂuid ﬂow using the lattice Boltzmann method, J.
Comput. Phys. 307 (2016) 355–377,https://doi.org/10.1016/j.jcp.2015.12.008.
[27] K. Yaji, T. Yamada, S. Kubo, K. Izui, S. Nishiwaki, A topology optimization
method for a coupled thermal–ﬂuid problem using level set boundary
expressions, Int. J. Heat Mass Transf. 81 (2015) 878–888, https://doi.org/
10.1016/j.ijheatmasstransfer.2014.11.005.
[28] X. Qian, E.M. Dede, Topology optimization of a coupled thermal-ﬂuid system
under a tangential thermal gradient constraint, Struct. Multidiscip. Optimiz.
https://doi.org/10.1007/s00158-016-1421-6.
[29] C. McConnell, G. Pingen, Multi-layer, pseudo 3D thermal topology
optimization of heat sinks, in: Volume 7: Fluids and Heat Transfer, Parts A,
B, C, and D, ASME International, 2012, https://doi.org/10.1115/imece2012-
93093.
[30] J.H.K. Haertel, K. Engelbrecht, B.S. Lazarov, O. Sigmund, Topology optimization
of thermal heat sinks, in: Proceedings of the COMSOL Conference 2015, 2015.
[31] J.H.K. Haertel, G.F. Nellis, A fully developed ﬂow thermoﬂuid model for
topology optimization of 3D-printed air-cooled heat exchangers, Appl. Therm.
Eng. 119 (2017) 10–24,https://doi.org/10.1016/j.applthermaleng.2017.03.030.
[32] E. Kontoleontos, E. Papoutsis-Kiachagias, A. Zymaris, D. Papadimitriou, K.
Giannakoglou, Adjoint-based constrained topology optimization for viscous
ﬂows, including heat transfer, Eng. Optimiz. 45 (8) (2013) 941–961,https://
doi.org/10.1080/0305215x.2012.717074.
[33] J. Alexandersen, N. Aage, C.S. Andreasen, O. Sigmund, Topology optimisation
for natural convection problems, Int. J. Numer. Meth. Fluids 76 (10) (2014)
699–721, https://doi.org/10.1002/ﬂd.3954.
[34] J. Alexandersen, O. Sigmund, N. Aage, Topology optimisation of passive coolers
for light-emitting diode lamps, in: Proceedings of the 11th World Congress of
Structural and Multidisciplinary Optimisation, 2015.
[35] J. Alexandersen, O. Sigmund, N. Aage, Large scale three-dimensional topology
optimisation of heat sinks cooled by natural convection, Int. J. Heat Mass
Transf. 100 (2016) 876–891, https://doi.org/10.1016/j.
ijheatmasstransfer.2016.05.013.
[36] P. Cofﬁn, K. Maute, A level-set method for steady-state and transient natural
convection problems, Struct. Multidiscip. Optimiz. 53 (5) (2016) 1047–1067,
https://doi.org/10.1007/s00158-015-1377-y.
[37] T. Borrvall, J. Petersson, Topology optimization of ﬂuids in stokes ﬂow, Int. J.
Numer. Meth. Fluids 41 (1) (2003) 77–107,https://doi.org/10.1002/ﬂd.426.
[38] M. Stolpe, K. Svanberg, An alternative interpolation scheme for minimum
compliance topology optimization, Struct. Multidiscip. Optimiz. 22 (2) (2001)
116–124, https://doi.org/10.1007/s001580100129.
[39] O. Sigmund, J. Petersson, Numerical instabilities in topology optimization: a
survey on procedures dealing with checkerboards, mesh-dependencies and
local minima, Struct. Optimiz. 16 (1) (1998) 68–75,https://doi.org/10.1007/
bf01214002.
[40] B.S. Lazarov, O. Sigmund, Filters in topology optimization based on Helmholtz-
type differential equations, Int. J. Numer. Meth. Eng. 86 (6) (2011) 765–781,
https://doi.org/10.1002/nme.3072.
[41] F. Wang, B.S. Lazarov, O. Sigmund, On projection methods, convergence and
robust formulations in topology optimization, Struct. Multidiscip. Optimiz. 43
(6) (2011) 767–784,https://doi.org/10.1007/s00158-010-0602-y.
[42] Comsol Multiphysics 5.2.
[43] O. Schenk, K. Gärtner, Solving unsymmetric sparse systems of linear equations
with PARDISO, Future Gener. Comput. Syst. 20 (3) (2004) 475–487,https://doi.
org/10.1016/s0167-739x(03)00188-2.
[44] K. Svanberg, A class of globally convergent optimization methods based on
conservative convex separable approximations, SIAM J. Optimiz. 12 (2) (2002)
555–573, https://doi.org/10.1137/s1052623499362822.
[45] M. Stolpe, K. Svanberg, On the trajectories of penalization methods for
topology optimization, Struct. Multidiscip. Optimiz. 21 (2) (2001) 128–139,
https://doi.org/10.1007/s001580050177.
[46] E.N. Jacobs, K.E. Ward, R.M. Pinkerton, The Characteristics of 78 Related Airfoil
Sections from Tests in the Variable-density Wind Tunnel, Tech. Rep., National
Advisory Committee for Aeronautics; Washington, DC, United States, 1933.
[47] N. Sahiti, A. Lemouedda, D. Stojkovic, F. Durst, E. Franz, Performance
comparison of pin ﬁn in-duct ﬂow arrays with various pin cross-sections,
Appl. Therm. Eng. 26 (11) (2006) 1176–1192, https://doi.org/10.1016/j.
applthermaleng.2005.10.042.
[48] F. Zhou, I. Catton, Numerical evaluation of ﬂow and heat transfer in plate-pin
ﬁn heat sinks with various pin cross-sections, Numer. Heat Transf. Part A:
Appl. 60 (2) (2011) 107–128,https://doi.org/10.1080/10407782.2011.588574.
[49] B.S. Lazarov, F. Wang, O. Sigmund, Length scale and manufacturability in
density-based topology optimization, Arch. Appl. Mech. 86 (1–2) (2016) 189–
218, https://doi.org/10.1007/s00419-015-1106-4.
[50] R.W. Hanks, The laminar-turbulent transition for ﬂow in pipes, concentric
annuli, and parallel plates, AIChE J. 9 (1) (1963) 45–48, https://doi.org/
10.1002/aic.690090110.
[51] K.K. Nielsen, K. Engelbrecht, C.R. Bahl, The inﬂuence of ﬂow maldistribution on
the performance of inhomogeneous parallel plate heat exchangers, Int. J. Heat
Mass Transf. 60 (2013) 432–439, https://doi.org/10.1016/j.
ijheatmasstransfer.2013.01.018.
[52] O. Pironneau, On optimum design in ﬂuid mechanics, J. Fluid Mech. 64 (1)
(1974) 97–110,https://doi.org/10.1017/s0022112074002023.
[53] D.W. Kim, M.-u. Kim, Minimum drag shape in two-dimensional viscous ﬂow,
Int. J. Numer. Meth. Fluids 21 (2) (1995) 93–111, https://doi.org/10.1002/
ﬂd.1650210202.
[54] T. Kondoh, T. Matsumori, A. Kawamoto, Drag minimization and lift
maximization in laminar ﬂows via topology optimization employing simple
objective function expressions based on body force integration, Struct.
Multidiscip. Optimiz. 45 (5) (2012) 693–701, https://doi.org/10.1007/
s00158-011-0730-z.
1088 J.H.K. Haertel et al. / International Journal of Heat and Mass Transfer 121 (2018) 1073–1088
